"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5510],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>v});var o=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var u=o.createContext({}),i=function(e){var n=o.useContext(u),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},p=function(e){var n=i(e.components);return o.createElement(u.Provider,{value:n},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},m=o.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,u=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=i(t),m=a,v=d["".concat(u,".").concat(m)]||d[m]||c[m]||r;return t?o.createElement(v,s(s({ref:n},p),{},{components:t})):o.createElement(v,s({ref:n},p))}));function v(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,s=new Array(r);s[0]=m;var l={};for(var u in n)hasOwnProperty.call(n,u)&&(l[u]=n[u]);l.originalType=e,l[d]="string"==typeof e?e:a,s[1]=l;for(var i=2;i<r;i++)s[i]=t[i];return o.createElement.apply(null,s)}return o.createElement.apply(null,t)}m.displayName="MDXCreateElement"},888:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>s,default:()=>c,frontMatter:()=>r,metadata:()=>l,toc:()=>i});var o=t(7462),a=(t(7294),t(3905));const r={sidebar_position:3,tags:["Linux","VPN","openVPN","proxy"]},s="VPN & Proxy",l={unversionedId:"network/vpn",id:"network/vpn",title:"VPN & Proxy",description:"Proxy to VPN",source:"@site/docs/network/vpn.md",sourceDirName:"network",slug:"/network/vpn",permalink:"/Wisdom-Hub/network/vpn",draft:!1,tags:[{label:"Linux",permalink:"/Wisdom-Hub/tags/linux"},{label:"VPN",permalink:"/Wisdom-Hub/tags/vpn"},{label:"openVPN",permalink:"/Wisdom-Hub/tags/open-vpn"},{label:"proxy",permalink:"/Wisdom-Hub/tags/proxy"}],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,tags:["Linux","VPN","openVPN","proxy"]},sidebar:"tutorialSidebar",previous:{title:"SSH",permalink:"/Wisdom-Hub/network/ssh"},next:{title:"DNS",permalink:"/Wisdom-Hub/network/dns"}},u={},i=[{value:"Proxy to VPN",id:"proxy-to-vpn",level:2},{value:"Tor",id:"tor",level:2},{value:"SSH",id:"ssh",level:2},{value:"Socks proxy over SSH",id:"socks-proxy-over-ssh",level:3},{value:"VPN over SSH",id:"vpn-over-ssh",level:2},{value:"openVPN Over Socks",id:"openvpn-over-socks",level:2},{value:"OpenVpn Server",id:"openvpn-server",level:2},{value:"V2Ray VPN/Proxy Server",id:"v2ray-vpnproxy-server",level:2},{value:"disable ping",id:"disable-ping",level:3},{value:"Change server hostname",id:"change-server-hostname",level:3},{value:"Add domain to the cloudflare",id:"add-domain-to-the-cloudflare",level:3},{value:"XUI Panel",id:"xui-panel",level:3},{value:"Nekoray",id:"nekoray",level:3},{value:"Cloudflare worker",id:"cloudflare-worker",level:2}],p={toc:i},d="wrapper";function c(e){let{components:n,...t}=e;return(0,a.kt)(d,(0,o.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"vpn--proxy"},"VPN & Proxy"),(0,a.kt)("h2",{id:"proxy-to-vpn"},"Proxy to VPN"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'pamac install tun2proxy\nsudo tun2proxy --setup --proxy "http://127.0.0.1:2080" --dns over-tcp  --bypass "104.21.32.243"\n# "104.21.32.243" is the IP of the VPN server\n')),(0,a.kt)("h2",{id:"tor"},"Tor"),(0,a.kt)("p",null,"In VPS:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"sudo apt install tor\nsudo systemctl enable tor\nsudo systemctl restart tor\nsudo nano /etc/tor/torrc\nSocksPort 0.0.0.0:9050 # Bind to this address:port too.\nSocksPolicy accept *\n\nsudo systemctl restart tor\njournalctl -u tor\ncurl --socks5 localhost:9050 https://check.torproject.org/\n\n")),(0,a.kt)("p",null,"In local Linux:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"ssh -L 9050:localhost:9050 -N mlibre@176.124.193.114\n")),(0,a.kt)("h2",{id:"ssh"},"SSH"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Configure the client")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"sudo nano /etc/systemd/system/sshtunnel.service\n\n[Unit]\nDescription=SSH Tunnels\nAfter=network.target\n\n[Service]\nUser=mlibre\nRestart=always\nRestartSec=20\nExecStart=ssh -L 0.0.0.0:1234:localhost:3128 -N server@95.216.208.60 -p 8756\n\n[Install]\nWantedBy=graphical.target\n")),(0,a.kt)("h3",{id:"socks-proxy-over-ssh"},"Socks proxy over SSH"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"sudo nano /etc/systemd/system/sshtunnelsocks.service\n[Unit]\nDescription=SSH Tunnels\nAfter=network.target\n\n[Service]\nUser=mlibre\nRestart=always\nRestartSec=20\nExecStart=ssh -D 3080 -C -N server@95.216.208.60 -p 8756\n\n[Install]\nWantedBy=graphical.target\n")),(0,a.kt)("h2",{id:"vpn-over-ssh"},"VPN over SSH"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"sudo pacman -S sshuttle\n\nsudo sshuttle -v -r mlibre@51.89.88.80 0/0 -x 51.89.88.80 --disable-ipv6\n\n# sudo nano /etc/resolv.conf\n# nameserver 1.1.1.1\n# nameserver 4.2.2.4\n# sudo systemctl restart systemd-resolved.service\n# sudo sshuttle -v -r mlibre@176.124.193.114 0/0 -x 0.0.0.0/0 --dns --disable-ipv6\n# sudo sshuttle -v -r mlibre@51.89.88.80 0/0 -x 51.89.88.80 --dns --disable-ipv6\n\n\n# sudo sshuttle -v -r mlibre@51.89.88.80 0.0.0.0/0 --dns --disable-ipv6\n# sudo sshuttle -vv -r mlibre@176.124.193.114 0/0 -x 0.0.0.0  --dns --disable-ipv6\n")),(0,a.kt)("h2",{id:"openvpn-over-socks"},"openVPN Over Socks"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"SS server address: 87.80.80.80")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"nano mlibre.ovpn\nsocks-proxy 127.0.0.1 1090\nroute 87.80.80.80 255.255.255.255 net_gateway\nroute 192.168.0.0 255.255.0.0 net_gateway\n")),(0,a.kt)("h2",{id:"openvpn-server"},"OpenVpn Server"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'https://github.com/mlibre/openvpn-install\ncurl -O https://raw.githubusercontent.com/angristan/openvpn-install/master/openvpn-install.sh\nchmod +x openvpn-install.sh\nsudo ./openvpn-install.sh\nport: random, tcp, curreny system resolver, compression yes\nscp -P 2138 mlibre@87.107.164.69:/home/mlibre/mlibre.ovpn .\n\nDNS_SERVER="1.1.1.1"\nsudo sh -c "echo nameserver $DNS_SERVER > /etc/resolv.conf"\nsudo sed -i \'/^\\s*#*DNS=/d\' /etc/systemd/resolved.conf && sudo sed -i \'$ a\\DNS=\'"$DNS_SERVER" /etc/systemd/resolved.conf\nsudo systemctl daemon-reload; wait;\nsudo systemctl restart systemd-networkd; wait;\nsudo systemctl restart systemd-resolved; wait;\nsudo systemd-resolve --flush-caches\nsudo resolvectl flush-caches\nsudo resolvectl dns eth0 "$DNS_SERVER"\nsudo resolvectl dns tun0 "$DNS_SERVER"\nsudo resolvectl dns enp3s0 "$DNS_SERVER"\nsudo resolvectl dns enp5s0 "$DNS_SERVER"\nsudo resolvectl dns docker0 "$DNS_SERVER"\nsudo resolvectl dns\nGlobal: 1.1.1.1\nLink 2 (enp3s0): 1.1.1.1\nLink 8 (tun0): 1.1.1.1\n\n\nAdd these lines to your .ovpn file:\n\nsocks-proxy 127.0.0.1 1080\nroute SHADOWSOCKS_SERVER_IP 255.255.255.255 net_gateway\n')),(0,a.kt)("h2",{id:"v2ray-vpnproxy-server"},"V2Ray VPN/Proxy Server"),(0,a.kt)("h3",{id:"disable-ping"},"disable ping"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"sudo nano /etc/sysctl.conf\nnet.ipv4.conf.icmp_echo_ignore_all = 1\n\nsudo nano /etc/sysctl.d/sys.conf\nnet.ipv4.conf.icmp_echo_ignore_all = 1\n")),(0,a.kt)("h3",{id:"change-server-hostname"},"Change server hostname"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"vultr.com -> server setting -> ipv4 -> reverse DNS")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"  proxychains ssh -p port true@000.000.13.13\n\n  sudo nano /etc/cloud/cloud.cfg\n  # preserve_hostname: true\n  \n  sudo nano /etc/hostname\n  domain.ga\n\n  sudo nano /etc/hosts\n  127.0.1.1 domain.ga\n\n  sudo hostnamectl set-hostname domain.ga\n")),(0,a.kt)("h3",{id:"add-domain-to-the-cloudflare"},"Add domain to the cloudflare"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"SSL/TLS: Full"),(0,a.kt)("li",{parentName:"ul"},"Disable DNSSEC, Always Use HTTPS, Automatic HTTPS Rewrites"),(0,a.kt)("li",{parentName:"ul"},"Enable TLS 1.3, HTTP2/3, GRPC, WS and ... in Network/SSL tab"),(0,a.kt)("li",{parentName:"ul"},"Enable Development mode"),(0,a.kt)("li",{parentName:"ul"},'Add a "A" DNS record: domain.ga, DNS only ( no proxy )'),(0,a.kt)("li",{parentName:"ul"},'Add a "A" DNS record: v4p.domain.ga, proxy'),(0,a.kt)("li",{parentName:"ul"},'Add a "AAAA" DNS record: v6.domain.ga, proxy ( don\'t make dns-only for ipv6 )')),(0,a.kt)("h3",{id:"xui-panel"},"XUI Panel"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"ssh root@ip\napt update\napt purge snapd ufw firewalld\napt dist-upgrade\napt install sudo git bash-completion zip unzip aria2 curl nano htop\nadduser mlibre\nusermod -a -G sudo mlibre\nsudo sh -c \"echo 'mlibre ALL=(ALL) NOPASSWD: ALL' >> /etc/sudoers\"\n# passwd mlibre\nreboot\n\nsudo ufw allow 2053\nsudo ufw allow 2053/udp\nsudo ufw allow 2053/tcp\nsudo ufw allow 35400\nsudo ufw allow 35400/udp\nsudo ufw allow 35400/tcp\nsudo ufw allow 2087\nsudo ufw allow 2087/udp\nsudo ufw allow 2087/tcp\nsudo ufw allow 2096\nsudo ufw allow 2096/udp\nsudo ufw allow 2096/tcp\nsudo ufw allow 8443\nsudo ufw allow 8443/udp\nsudo ufw allow 8443/tcp\nsudo ufw allow 2053\nsudo ufw allow 2053/udp\nsudo ufw allow 2053/tcp\nsudo ufw allow 3678\nsudo ufw allow 3678/udp\nsudo ufw allow 3678/tcp\nsudo ufw allow 2289\nsudo ufw allow 2289/udp\nsudo ufw allow 2289/tcp\nsudo ufw allow 9090\nsudo ufw allow 9090/udp\nsudo ufw allow 9090/tcp\nsudo ufw allow 1080\nsudo ufw allow 1080/udp\nsudo ufw allow 1080/tcp\nsudo ufw allow 443\nsudo ufw allow 443/tcp\nsudo ufw allow 443/udp\nsudo ufw allow 80\nsudo ufw allow 80/tcp\nsudo ufw allow 80/udp\nsudo ufw allow 5353\nsudo ufw allow 5353/tcp\nsudo ufw allow 5353/udp\nsudo ufw allow 53\nsudo ufw allow 53/tcp\nsudo ufw allow 53/udp\nsudo ufw allow OpenSSH\nsudo ufw allow https\nsudo ufw allow ssh\nsudo ufw allow www\nsudo ufw allow bootps\nsudo ufw allow dns\n\n\ncd\nbash <(curl -Ls https://raw.githubusercontent.com/mhsanaei/3x-ui/master/install.sh)\n# cat /usr/local/x-ui/bin/config.json\n# tar -czvf x-ui.tgz /usr/local/x-ui/\n# proxychains scp -P 3612 true@199.247.13.13:x-ui.tgz .\n# proxychains scp -P 3612 root@199.247.13.13:cert.crt .\n# proxychains scp -P 3612 root@199.247.13.13:private.key .\n\n\nsudo su\nx-ui\n# Open ports, active firewall\n# install BBR, WARP\n\n    # warp u => Uninstall Warp\n    # warp a => Change Warp Account Type (free, plus, ...)\n    # warp y => Turn on/off WireProxy\n\n# revoke certificate the root domain\n# issue certificate\n# Set Panel port 8443\n# Set the certs for panel\nls\nacme.sh --info\nacme.sh --list\n# lsof -i :80\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Open Panel (",(0,a.kt)("a",{parentName:"li",href:"https://domain.ga:8443/xui/inbounds"},"https://domain.ga:8443/xui/inbounds"),")"),(0,a.kt)("li",{parentName:"ul"},"vless-2096-h2-reality-no-sniff-stackoverflow.com:443"),(0,a.kt)("li",{parentName:"ul"},"trojan-tls-TCP-443-allow-insecure-alp-all-sni-stackoverflow.com"),(0,a.kt)("li",{parentName:"ul"},"vmess-ws-tls-2053-allow-insecure-aph-all"),(0,a.kt)("li",{parentName:"ul"},"vmess-h2-TLS-H2-HTTP1-allow-insecure-stackoverflow.com-80"),(0,a.kt)("li",{parentName:"ul"},"vmess-h2-TLS-H2-allow-insecure-8443"),(0,a.kt)("li",{parentName:"ul"},"In firefox: Check Proxy DNS when using SOCKS v5")),(0,a.kt)("h3",{id:"nekoray"},"Nekoray"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Nekoray Supports SS, Vmess and ...."),(0,a.kt)("li",{parentName:"ul"},"Download from ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/Matsuridayo/nekoray/releases"},"https://github.com/Matsuridayo/nekoray/releases"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'aria2c -x 10 "https://github.com/MatsuriDayo/nekoray/releases/download/2.9/nekoray-2.9-2022-12-19-linux64.zip"\nunzip nekoray-2.9-2022-12-19-linux64.zip\ncd nekoray\n./nekoray\n# Settings -> security -> Skip TLS certificate\n# paste vmess setting. Address: portal.domain.ga, host: portal.domain.ga\n# paste vmess setting. Address: iv6.domain.ga, host: iv6.domain.ga\n')),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Open Nekoray -> Routing Settings -> remote DNS: localhost")),(0,a.kt)("h2",{id:"cloudflare-worker"},"Cloudflare worker"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/iErfun/BPB-Panel-EN/"},"https://github.com/iErfun/BPB-Panel-EN/")))}c.isMDXComponent=!0}}]);